!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var s in n)("object"==typeof exports?exports:e)[s]=n[s]}}(global,(()=>(()=>{var e={495:(e,t,n)=>{const s={backgroundColor:"#fff",resizable:!0,alwaysOnTop:!1,frame:!1,transparent:!1,show:!1,hasShadow:!0,autoHideMenuBar:!0,titleBarStyle:"hiddenInset",acceptFirstMouse:!0,webPreferences:{nodeIntegrationInWorker:!0,enableRemoteModule:!0,contextIsolation:!1,nodeIntegration:!0,enableWebSQL:!1,webSecurity:!1,spellcheck:!1,webgl:!0,preload:n(17).join(global._MAIN_ROOT_PATH_,"./preload.js")}},o={...s,webPreferences:{...s.webPreferences,devTools:!0}},i={...s,webPreferences:{...s.webPreferences,devTools:!1}};e.exports={commonConfig:s,devConfig:o,prodConfig:i}},241:(e,t,n)=>{const s=n(8),{devConfig:o,prodConfig:i}=n(495),r=new s({defaultConfig:Object.assign({},global._IS_DEV_?o:i)});e.exports=r},516:(e,t,n)=>{const{ipcMain:s,app:o}=n(496),i=n(241);function r(e,{target:t,channel:n,message:s}){const o=i.getInstance(t);o&&o.webContents.send(n,s,e.sender.browserWindowOptions.name)}function a(e,{channel:t,message:n}){const s=i._wins;Object.keys(s).forEach((o=>e.sender.browserWindowOptions.name!==o&&s[o].webContents.send(t,n)))}e.exports={handleSendTo:r,handleMessageBus:a,bindIpcEvent:function(){const e={PING:()=>(new Promise).resolve("OK"),GET_WIN_NAMES:()=>Object.keys(i._wins)},t={QUIT:()=>o.quit(),DESTROY_WIN:(e,{name:t})=>i.destroy(t),DESTROY_ALL_WIN:()=>i.destroyAll(),SEND_TO:r,MESSAGE_BUS:a,WINDOW_MANAGER:(e,{name:t,action:n,args:s=[]})=>{t?i.getInstance(t)[n](...s):i[n](...s)}},n={GET_GLOBAL_VARIABLE:(e,{key:t})=>global[t]};for(const e in n)s.handle("COMMON_IPC::"+e,n[e]);for(const t in e)s.handle("RESPONSIVE_IPC::"+t,e[t]);for(const e in t)s.on("BROWSER_IPC::"+e,t[e])}}},116:(e,t,n)=>{const{Tray:s,nativeImage:o,Menu:i}=n(496),r=n(17);let a=null;e.exports={run:function(){const e=r.join(global._RESOURCES_,"icons",global._IS_MAC_?"icon_mini_white_256.png":"icon_mini_gradient_256.png");a=new s(o.createFromPath(e).resize({width:16,height:16}));const t=i.buildFromTemplate([{label:"首选项"},{label:"检查更新"},{label:"退出",click:()=>{n(496).app.exit()}}]);a.setContextMenu(t)},getTray:function(){return a}}},8:(e,t,n)=>{e.exports=n(265)},265:(e,t,n)=>{const{BrowserWindow:s}=n(496),{BrowserWindowPool:o}=n(992),i=n(491).ok,{update:r}=n(517),{setBoundsByPosition:a,isFatherSonRelationship:l}=n(95),c=n(1),h=!("win32"===process.platform);e.exports=class{constructor(e){this._wins={},this._winsPool=[],this.browserConfig=e.defaultConfig||{},this._poolInstance=new o(this.browserConfig),this._eventFunctions={},this._winsRelationMap={}}createWithPool(e={}){const t=this._poolInstance.getBrowserWindow(e);this.register(t,e),t.show()}create(e={},t=null){if(i(e.name,"You must set [name] in config when using create"),this.getInstance(e.name))return void this.getInstance(e.name).show();e.parentName&&!e.parent&&(e.parent=this.getInstance(e.parentName)),e.secure&&(this.browserConfig.webPreferences.contextIsolation=!0);const n=new s({...this.browserConfig,...e,webPreferences:{...this.browserConfig.webPreferences||{},...e.webPreferences||{}},show:!1});return e.loadURL&&n.loadURL(e.loadURL),e.loadFile&&n.loadFile(e.loadFile),e.show&&n.on("ready-to-show",(()=>{n.show()})),this.register(n,e,t),n}refresh(e={},t=null){const n=this.getInstance(e.name);n&&(e.loadURL&&n.loadURL(e.loadURL),e.loadFile&&n.loadFile(e.loadFile),t&&this.getInstance(e.parentName)&&this.setPosition(e,t),n.show())}register(e,t,n){e.name=t.name,e.parentName=t.parentName||"",e.__setBounds=e.setBounds,e.setBounds=e=>this.setCustomBounds(t.name,e),this._wins[e.name]=e;const s=this._winsRelationMap[e.parentName];this._winsRelationMap[e.name]=(s?`${s}::`:"")+e.name,e.on("closed",(()=>{this.deregister(e.name)})),n&&e.parentName&&this.getInstance(e.parentName)&&this.setPosition(t,n),this.addDevTools(e.name,t?.pluginOptions?.addDevTools)}deregister(e){if(!this._wins[e])return;const t=this.getParentWinName(this._winsRelationMap[e]);t&&this.__cancelEventFunction(t,void 0,e);for(const t in this._wins){const n=this._winsRelationMap[t];l(e,n)&&this._wins[t]&&this._wins[t].close()}delete this._winsRelationMap[e],delete this._wins[e]}setPosition(e,t){const n=this.getInstance(e.name);this.freshExtraInfo(e.name),this.__cancelEventFunction(e.parentName,"resized",e.name),this.__cancelEventFunction(e.parentName,"move",e.name),t.immediate&&a(t,this.getInstance(e.parentName),n),this.__registerEventFunction(e.parentName,"resized",(e=>{a(t,e.sender,n)}),e.name),h&&e.parent||this.__registerEventFunction(e.parentName,"move",(e=>{a(t,e.sender,n)}),e.name)}__registerEventFunction(e,t,n,s){return this.getInstance(e).on(t,n),s&&(n.__relation=s),r(this._eventFunctions,`[${e}][${t}]`,(e=>Array.isArray(e)?[...e,n]:[n])),this}__cancelEventFunction(e,t,n){const s=this.getInstance(e);if(!s)return;const o=this._eventFunctions?.[e];if(o){if(e&&t){let e=o?.[t];if(!e)return;return e.forEach(((o,i)=>{n&&o.__relation!==n||(s.removeListener(t,o),e[i]=null)})),o[t]=e.filter(Boolean),void(e=null)}e&&Object.keys(o).forEach((e=>{const t=o?.[e];t&&(t.forEach(((o,i)=>{n&&o.__relation!==n||(s.removeListener(e,o),t[i]=null)})),o[e]=t.filter(Boolean))}))}}getParentWinName(e){return e.replace(/(::)?[^(::)]+$/,"")}getSonWinsNames(e){return Object.keys(this._wins).map((t=>l(e,t)))}getInstance(e){return e?this._wins[e]||null:this._wins}getAllVisibleWindows(){return Object.keys(this._wins).map((e=>({name:e,instance:this._wins[e]}))).filter((e=>e.instance&&e.instance.isVisible()))}hiddenAllWindows(){Object.keys(this._wins).forEach((e=>{const t=this.getInstance(e);t?.hide&&t.hide()}))}destroy(e){this._wins[e]?this._wins[e].close():console.error(e+"窗口不存在")}destroyAll(){this.destroy("main")}operate(e,t,...n){const s=this.getInstance(e);s&&s[t](...n)}freshExtraInfo(e,t={}){const n=this.getInstance(e);n&&(n.bounds||n.on("resized",(function(e){n.bounds=n.getBounds()})),n.bounds=t.bounds||n.getBounds())}setCustomBounds(e,t){const n=this.getInstance(e);if(!n)return;const{x:s,y:o}=n.getBounds(),i={...n.bounds||{},x:s,y:o,...t};n.__setBounds&&n.__setBounds(i),n.bounds=i}addDevTools(e,t={}){const{prodValid:s=!1,devValid:o=!0,hotKey:i="Alt+Shift+T"}=t,r=this.getInstance(e);(c&&o||!c&&s)&&n(406).register(r,i,(()=>r.webContents.openDevTools()))}}},992:(e,t,n)=>{const{BrowserWindow:s}=n(496),{resetBrowser:o}=n(95),i=[];e.exports={BrowserWindowPool:class{constructor(e={},t=2){this.pool=i,this._depth=t,this._defaultConfig=e,this.__initPool(t)}__generateInstance(e={show:!1}){return new s({...this._defaultConfig,...e})}__initPool(e){for(;e>0;)--e,this.pool.push(this.__generateInstance())}getBrowserWindow(e){return this.pool.push(this.__generateInstance()),o(this.pool.shift(),e)}}}},95:e=>{function t(e){return String(e).includes("%")}function n(e){return/^(calc\().*\)$/.test(e+"")}function s(e,t,n){switch(t){case"+":return e+n;case"-":return e-n;case"*":return e*n;case"/":return e/n}}function o(e,o){let i=e;if(t(e)&&(i=parseInt(e)/100*o),n(e)){let[n,r,a]=e.replace(/(calc\()|\)/g,"").split(" ");n=t(n)?parseInt(n)/100*o:+n,a=t(a)?parseInt(a)/100*o:+a,i=s(n,r,a)}return+i}function i(e,t){const{x:n,y:s,width:i,height:r}=t,a={};return"top"in e&&(a.top=Math.ceil(s+o(e.top,r))),"bottom"in e&&(a.bottom=Math.ceil(s+r-o(e.bottom,r))),"left"in e&&(a.left=Math.ceil(n+o(e.left,i))),"right"in e&&(a.right=Math.ceil(n+i-o(e.right,i))),a}e.exports={isFatherSonRelationship:function(e,t){const n=(e.match(/::/g)||[]).length;return t.startsWith(e)&&(t.match(/::/g)||[]).length===n+1},setBoundsByPosition:function(e,t,n){const s=i(e,t.getBounds()),{top:o,bottom:r,left:a,right:l}=s,{width:c,height:h}=n.getBounds();n.setBounds({x:a||l-c,y:o||r-h}),o&&r&&o<r&&n.setBounds({height:r-o}),a&&l&&a<l&&n.setBounds({width:l-a})},convertedPosition:o,getNumberPosition:i,isPercentage:t,isCalc:n,operation:s,resetBrowser:function(e,t){if(console.time("resetBrowser"),("x"in t||"y"in t)&&e.setPosition(t.x,t.y),("width"in t||"height"in t)&&e.setSize(t.width,t.height),"center"in t&&e.center(),("minHeight"in t||"minWidth"in t)&&e.setMinimumSize(t.minWidth,t.minHeight),"resizable"in t&&e.setResizable(t.resizable),"movable"in t&&e.setResizable(t.resizable),"minimizable"in t&&e.setResizable(t.resizable),"maximizable"in t&&e.setResizable(t.resizable),"closable"in t&&e.setClosable(t.closable),"focusable"in t&&e.setFocusable(t.focusable),"alwaysOnTop"in t){const[n,...s]="boolean"==typeof t.alwaysOnTop?[t.alwaysOnTop]:t.alwaysOnTop.split(":");e.setAlwaysOnTop(n,...s)}return"fullscreen"in t&&e.setFullscreen(t.fullscreen),"fullscreenable"in t&&e.setFullscreenable(t.fullscreenable),"simpleFullscreen"in t&&e.setSimpleFullScreen(t.simpleFullscreen),"skipTaskbar"in t&&e.setSkipTaskbar(t.skipTaskbar),"title"in t&&e.setTitle(t.title),"loadURL"in t&&e.webContents.loadURL(t.loadURL),"loadFile"in t&&e.loadFile(t.loadFile),console.timeEnd("resetBrowser"),e}}},758:(e,t,n)=>{const s={main:n(312)};e.exports={newWindow:function(e,t){const n=s.main;if(!n)throw new Error(`cant create [${e}]`);return n(t)}}},312:(e,t,n)=>{e.exports=function(e={}){const t=n(241).create({width:800,height:800,name:"main",show:!0,loadURL:global._RENDERER_URL_,pluginOptions:{addDevTools:{prodValid:!0}},webPreferences:{enableRemoteModule:!0,devTools:!0},...e});return t.webContents.openDevTools(),t}},496:e=>{"use strict";e.exports=require("electron")},1:e=>{"use strict";e.exports=require("electron-is-dev")},406:e=>{"use strict";e.exports=require("electron-localshortcut")},517:e=>{"use strict";e.exports=require("lodash")},491:e=>{"use strict";e.exports=require("assert")},17:e=>{"use strict";e.exports=require("path")}},t={};function n(s){var o=t[s];if(void 0!==o)return o.exports;var i=t[s]={exports:{}};return e[s](i,i.exports,n),i.exports}return(()=>{const{app:e}=n(496),{getTray:t,run:s}=n(116);let o=null;process.on("uncaughtException",(e=>console.error("node未处理异常",e.stack))),process.on("unhandledRejection",(e=>console.error("node未处理Promise错误",e))),e.whenReady().then((()=>{s(),n(516).bindIpcEvent(),o=n(758).newWindow("main")})),e.once("before-quit",(()=>{const e=t();e&&e.destroy()})),e.on("second-instance",(()=>{if(o)return o.show();e.exit()}))})(),{}})()));